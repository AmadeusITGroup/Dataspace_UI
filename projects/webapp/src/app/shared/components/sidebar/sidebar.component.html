<nav class="sidebar d-flex flex-column flex-shrink-0 p-0 overflow-hidden h-100">
  <ul class="nav nav-pills flex-column mb-auto">
    @for (item of menu; track item.id) {
      <li class="nav-item">
        @if (!item.items.length) {
          <a
            class="nav-link"
            aria-current="page"
            role="button"
            [routerLink]="item.link"
            routerLinkActive="active"
            tabindex="0"
          >
            <span class="sidebar-icon bi-{{ item.icon }}"></span>
            {{ item.title }}
          </a>
        } @else {
          @let open = isOpen(item);
          <a
            class="nav-link"
            aria-current="page"
            role="button"
            data-bs-toggle="collapse"
            [attr.aria-expanded]="open"
            [attr.aria-controls]="item.id"
            (click)="toggleCollapse(item)"
            (keyup.enter)="toggleCollapse(item)"
            tabindex="{{ open ? '0' : '-1' }}"
          >
            <span class="sidebar-icon bi-{{ item.icon }}"></span>
            {{ item.title }}
            <span [class]="{ 'bi-caret-down-fill': !open, 'bi-caret-up-fill': open }"></span>
          </a>
          <ul class="collapse list-unstyled" id="{{ item.id }}" [class]="{ show: open }">
            @for (subitem of item.items; track subitem.id) {
              <li class="subitem">
                <a
                  class="dropdown-item nav-link"
                  [routerLink]="subitem.link"
                  routerLinkActive="active"
                  tabindex="0"
                >
                  {{ subitem.title }}
                </a>
              </li>
            }
          </ul>
        }
      </li>
    }
  </ul>
</nav>
